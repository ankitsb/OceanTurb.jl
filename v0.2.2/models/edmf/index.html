<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>An eddy-diffusivity mass-flux (EDMF) scheme · OceanTurb.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>OceanTurb.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><a class="toctext" href="../../basics/">Turbulence, fluxes, and physics</a></li><li><a class="toctext" href="../../numerics/">Numerical methods</a></li><li><span class="toctext">Turbulence models</span><ul><li><a class="toctext" href="../kpp/">The K-Profile-Parameterization (KPP)</a></li><li><a class="toctext" href="../modular_kpp/">Modular K-Profile Parameterization</a></li><li class="current"><a class="toctext" href>An eddy-diffusivity mass-flux (EDMF) scheme</a><ul class="internal"><li><a class="toctext" href="#Turbulent-eddy-diffusivty-and-mass-flux-1">Turbulent eddy diffusivty and mass flux</a></li><li><a class="toctext" href="#Zero-plume,-1.5-order-EDMF-scheme-1">Zero-plume, 1.5-order EDMF scheme</a></li></ul></li><li><a class="toctext" href="../pacanowskiphilander/">Pacanowski-Philander</a></li></ul></li><li><span class="toctext">DocStrings</span><ul><li><a class="toctext" href="../../man/types/">Private types</a></li><li><a class="toctext" href="../../man/functions/">Functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Turbulence models</li><li><a href>An eddy-diffusivity mass-flux (EDMF) scheme</a></li></ul><a class="edit-page" href="https://github.com/glwagner/OceanTurb.jl/blob/master/docs/src/models/edmf.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>An eddy-diffusivity mass-flux (EDMF) scheme</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="An-eddy-diffusivity-mass-flux-(EDMF)-scheme-1" href="#An-eddy-diffusivity-mass-flux-(EDMF)-scheme-1">An eddy-diffusivity mass-flux (EDMF) scheme</a></h1><div>\[\newcommand{\c}         {\, ,}
\newcommand{\p}         {\, .}
\newcommand{\d}         {\partial}
\newcommand{\r}[1]      {\mathrm{#1}}
\newcommand{\b}[1]      {\boldsymbol{#1}}
\newcommand{\ee}        {\mathrm{e}}
\newcommand{\di}        {\, \mathrm{d}}
\newcommand{\ep}        {\epsilon}

\newcommand{\beq}       {\begin{equation}}
\newcommand{\eeq}       {\end{equation}}
\newcommand{\beqs}      {\begin{gather}}
\newcommand{\eeqs}      {\end{gather}}

% Non-dimensional numbers
\newcommand{\Ri}        {\mathrm{Ri}}
\newcommand{\K}         {\mathrm{KE}}        

\newcommand{\btau}      {\b{\tau}} % wind stress vector

% Model functions and constants
\renewcommand{\F}[2]    {\Upsilon^{#1}_{#2}}
\renewcommand{\C}[2]    {C^{#1}_{#2}}

\newcommand{\uwind}     {u_\star}
\newcommand{\ubuoy}     {w_\star}

\newcommand{\defn}      {\stackrel{\r{def}}{=}}\]</div><p>The EDMF family of schemes parameterizes turbulent convection by introducing a conditional average that partitions the subgrid boundary layer flow into a turbulent &#39;environment&#39; with area <span>$a_0$</span>, and non-turbulent updrafts and downdrafts with areas <span>$a_i$</span> for <span>$i&gt;0$</span>.</p><p>We consider two types of EDMF schemes: those with prognostic equations that model the time-evolution and spatial distribution of turbulent kinetic energy (TKE), and those that parameterize the effect of turbulent environmental mixing with a &#39;K-profile&#39;.</p><h2><a class="nav-anchor" id="Turbulent-eddy-diffusivty-and-mass-flux-1" href="#Turbulent-eddy-diffusivty-and-mass-flux-1">Turbulent eddy diffusivty and mass flux</a></h2><p>In all schemes, the turbulent velocity fluxes are parameterized with an eddy diffusivity. For the <span>$x$</span>-velocity <span>$U$</span>, for example,</p><div>\[\beq
\overline{w u} = \d_z \left ( K \d_z U \right ) \c
\eeq\]</div><p>where <span>$K$</span> is the eddy diffusivity. We consider various models for eddy diffusivity ranging from a model similar to the K-profile parameterizaton (KPP), and a formulation in terms of a prognostic, time- and <span>$z$</span>-dependent turbulent kinetic energy variable, <span>$e$</span>. The turbulent flux of scalars <span>$\phi$</span> such as temperature and salinity is parameterized by both a turbulent flux and mass transport,</p><div>\[\beq
\overline{u \phi} = \d_z \left ( K \d_z \Phi \right )
  - \d_z \sum_i a_i \tilde W_i \tilde \Phi_i \c
\eeq\]</div><p>where <span>$\tilde \Phi_i$</span> is the difference between the average of <span>$\phi$</span> within domain <span>$i$</span> and the total horizontal average <span>$\Phi$</span>:</p><div>\[\begin{align}
\tilde \Phi_i &amp; \defn \left ( \frac{1}{A_i} \int_{A_i} \r{d} A - \frac{1}{A} \int_A \r{d} A \right ) \phi \c \\
&amp;= \Phi_i - \Phi \c
\end{align}\]</div><p>where we have introduced the notation <span>$\Phi_i$</span> to denote the average of <span>$\phi$</span> within the environment or updraft area <span>$A_i$</span>. The terms <span>$a_i \tilde W_i \tilde \Phi_i$</span> account for the vertical transport of <span>$\phi$</span> by environment and updraft vertical velocities <span>$W_i$</span>.</p><h2><a class="nav-anchor" id="Zero-plume,-1.5-order-EDMF-scheme-1" href="#Zero-plume,-1.5-order-EDMF-scheme-1">Zero-plume, 1.5-order EDMF scheme</a></h2><p>A relatively simple EDMF scheme emerges in the limit of vanishing updrafts and downdrafts, in which case <span>$W = W_0 = a_0 = 0$</span>. In the 1.5-order version of this closure, turbulent diffusivity is modeled via the prognostic turbulent kinetic energy (TKE) equation</p><div>\[\beq
\d_t e = K \left [ \left ( \d_z U \right )^2 + \left ( \d_z V \right )^2 \right ] + \d_z \left ( K \d_z e \right )
  - K \d_z B - \C{\ep}{} \frac{e^{3/2}}{\ell} \c
  \label{TKE}
\eeq\]</div><p>where <span>$\C{\ep}{} = 2.0$</span> is a model parameter, <span>$\d_z B = g \left( \alpha \d_z T - \beta \d_z S \right )$</span> is the buoyancy gradient in terms of gravitational acceleration <span>$g$</span> and thermal expansion and haline contraction coefficients <span>$\alpha$</span> and <span>$\beta$</span>, and <span>$K$</span> is the eddy diffusivity defined in terms of turbulent &#39;velocity&#39; <span>$\sqrt{e}$</span> and a mixing length <span>$\ell$</span>:</p><div>\[\beq
K = \C{K}{} \underbrace{
      \C{\kappa}{} z \left ( 1 - \F{a}{} \tfrac{Q_b}{\uwind^3} z \right )^{\F{n}{}}}
        _{\defn \ell}
        \, \sqrt{e} \p
        \label{eddydiffusivity}
\eeq\]</div><p>In \eqref{eddydiffusivity}, <span>$Q_b = g \left ( \alpha Q_\theta - \beta Q_s \right )$</span> is the buoyancy flux define in terms of temperature and salinity fluxes <span>$Q_\theta$</span> and <span>$Q_s$</span>, and <span>$\uwind \defn | \b{Q}_u |^{1/2}$</span> is the friction velocity defined in terms of velocity flux <span>$\b{Q}_u = \b{\tau} / \rho_0$</span> or wind-stress <span>$\b{\tau}$</span> and reference density <span>$\rho_0$</span>. <span>$\C{\kappa}{} = 0.41$</span> and <span>$\C{K}{} = 0.1$</span> in \eqref{eddydiffusivity} are the &#39;Von Karman&#39; and eddy diffusivity model parameters, respectively. <span>$\F{a}{}$</span> and <span>$\F{n}{}$</span> in \eqref{eddydiffusivity} are piecewise constant model functions that model the effect of boundary layer stability on the mixing length and are</p><div>\[\beq
\F{a}{} = \left \{ \begin{matrix}
-100 &amp; \text{for unstable boundary layers with } Q_b &gt; 0 \\
2.7 &amp; \text{for stable boundary layers with } Q_b \le 0
\end{matrix} \right . \c
\eeq\]</div><p>and</p><div>\[\beq
\F{n}{} = \left \{ \begin{matrix}
0.2 &amp; \text{for unstable boundary layers with } Q_b &gt; 0 \\
-1 &amp; \text{for stable boundary layers with } Q_b \le 0
\end{matrix} \right . \p
\eeq\]</div><p>Note that parameterized buoyancy flux <span>$\overline{w b} \defn -K \d_z B$</span> appears in the TKE equation \eqref{TKE}.</p><footer><hr/><a class="previous" href="../modular_kpp/"><span class="direction">Previous</span><span class="title">Modular K-Profile Parameterization</span></a><a class="next" href="../pacanowskiphilander/"><span class="direction">Next</span><span class="title">Pacanowski-Philander</span></a></footer></article></body></html>
